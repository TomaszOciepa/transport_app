<div class="container py-5">
  <div class="row justify-content-center">
    <div class="col-md-10">
      <div class="card shadow-lg rounded-4">
        <div class="card-header bg-success text-white text-center">
          <h4>Podsumowanie zamówienia</h4>
        </div>
        <div class="card-body p-4">
          <p><strong>Adres odbioru:</strong> <%= @order.pickup_address %></p>
          <p><strong>Adres dostawy:</strong> <%= @order.delivery_address %></p>
          <p><strong>Pojazd:</strong> <%= @order.vehicle_type.name %></p>
          <p><strong>Usługa:</strong> <%= @order.service_type.name %></p>
          <p><strong>Przewidywana data dostawy:</strong> <%= @order.delivery_date&.strftime("%d-%m-%Y %H:%M") %></p>
          <p><strong>Cena:</strong> <%= number_to_currency(@order.price, unit: "PLN") %></p>

          <!-- Mapa -->
          <div id="map" style="height: 400px; border-radius: 12px;"></div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Leaflet mapa -->
<link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>

<script>
  document.addEventListener("DOMContentLoaded", function() {
    var map = L.map('map').setView([<%= @order.pickup_lat || 52.2297 %>, <%= @order.pickup_lon || 21.0122 %>], 6);

    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
      attribution: '© OpenStreetMap contributors'
    }).addTo(map);

    var route = [
      [<%= @order.pickup_lat || 52.2297 %>, <%= @order.pickup_lon || 21.0122 %>],
      [<%= @order.delivery_lat || 50.0647 %>, <%= @order.delivery_lon || 19.9450 %>]
    ];

    L.polyline(route, {color: 'blue', weight: 4}).addTo(map);
    map.fitBounds(route);
  });
</script>
